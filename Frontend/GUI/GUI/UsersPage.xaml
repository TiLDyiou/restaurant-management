<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:conv="clr-namespace:RestaurantManagementGUI.Converters"
             x:Class="RestaurantManagementGUI.UsersPage"
             BackgroundColor="#263238"
             Shell.NavBarIsVisible="True"
             Title="Quáº£n lÃ½ nhÃ¢n viÃªn">

    <ContentPage.Resources>
        <Color x:Key="PrimaryColor">#263238</Color>
        <Color x:Key="AccentColor">#FFBD59</Color>
        <Color x:Key="LightBackground">#FAFAFA</Color>
        <Color x:Key="TextPrimary">#FFFFFF</Color>
        <Color x:Key="TextSecondary">#B0BEC5</Color>

        <conv:StatusColorConverter x:Key="StatusColorConverter"/>
        <conv:CanEditConverter x:Key="CanEditConverter"/>
        <conv:StatusButtonTextConverter x:Key="StatusButtonTextConverter"/>
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="18">

            <!-- TiÃªu Ä‘á» -->
            <Label Text="Danh sÃ¡ch nhÃ¢n viÃªn"
                   FontSize="22"
                   FontAttributes="Bold"
                   TextColor="{StaticResource AccentColor}"
                   HorizontalOptions="Center"/>

            <!-- Thanh tÃ¬m kiáº¿m -->
            <SearchBar x:Name="SearchBarUsers"
                       Placeholder="ðŸ” TÃ¬m kiáº¿m theo mÃ£ hoáº·c tÃªn nhÃ¢n viÃªn..."
                       PlaceholderColor="#B0BEC5"
                       TextColor="#FFFFFF"
                       BackgroundColor="#37474F"
                       HeightRequest="45"
                       FontSize="16"
                       Margin="0,5,0,10"
                       TextChanged="OnSearchTextChanged" />

            <!-- NÃºt thÃªm nhÃ¢n viÃªn -->
            <Button Text="âž• ThÃªm nhÃ¢n viÃªn"
                    BackgroundColor="{StaticResource AccentColor}"
                    TextColor="{StaticResource PrimaryColor}"
                    CornerRadius="12"
                    HeightRequest="50"
                    FontAttributes="Bold"
                    Clicked="OnAddUserClicked" />

            <!-- Danh sÃ¡ch nhÃ¢n viÃªn -->
            <CollectionView x:Name="UsersCollectionView"
                            SelectionMode="Single">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame BorderColor="{StaticResource AccentColor}"
                               CornerRadius="14"
                               BackgroundColor="{StaticResource LightBackground}"
                               Padding="15"
                               Margin="0,8"
                               HasShadow="True">
                            <VerticalStackLayout Spacing="6">

                                <Label Text="{Binding HoTen, StringFormat='ðŸ‘¤ Há» tÃªn: {0}'}"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="#000000" />

                                <Label Text="{Binding MaNV, StringFormat='ðŸ†” MÃ£ nhÃ¢n viÃªn: {0}'}"
                                       FontSize="14"
                                       TextColor="#333333" />

                                <Label Text="{Binding ChucVu, StringFormat='ðŸ’¼ Chá»©c vá»¥: {0}'}"
                                       FontSize="14"
                                       TextColor="#444444" />

                                <Label Text="{Binding SDT, StringFormat='ðŸ“ž Sá»‘ Ä‘iá»‡n thoáº¡i: {0}'}"
                                       FontSize="14"
                                       TextColor="#444444" />

                                <Label Text="{Binding Email, StringFormat='ðŸ“§ Email: {0}'}"
                                       FontSize="14"
                                       TextColor="#444444" />

                                <Label Text="{Binding Quyen, StringFormat='ðŸ”’ Quyá»n: {0}'}"
                                       FontSize="14"
                                       TextColor="#757575" />

                                <Label Text="{Binding TrangThai, StringFormat='âš¡ Tráº¡ng thÃ¡i: {0}'}"
                                       FontSize="14"
                                       FontAttributes="Bold"
                                       TextColor="{Binding TrangThai, Converter={StaticResource StatusColorConverter}}" />

                                <!-- NÃºt hÃ nh Ä‘á»™ng -->
                                <HorizontalStackLayout Spacing="10" Margin="0,10,0,0">

                                    <!-- NÃºt Sá»­a -->
                                    <Button Text="âœï¸ Sá»­a"
                                            BackgroundColor="{StaticResource AccentColor}"
                                            TextColor="{StaticResource PrimaryColor}"
                                            CornerRadius="8"
                                            FontAttributes="Bold"
                                            Clicked="OnEditClicked"
                                            IsEnabled="{Binding TrangThai, Converter={StaticResource CanEditConverter}}"
                                            Padding="10,0"/>

                                    <!-- NÃºt Nghá»‰ viá»‡c / Quay láº¡i -->
                                    <Button Text="{Binding TrangThai, Converter={StaticResource StatusButtonTextConverter}}"
                                            BackgroundColor="#FFA000"
                                            TextColor="White"
                                            CornerRadius="8"
                                            FontAttributes="Bold"
                                            Clicked="OnToggleStatusClicked"
                                            Padding="10,0"/>

                                    <!-- NÃºt XÃ³a -->
                                    <Button Text="ðŸ—‘ XÃ³a"
                                            BackgroundColor="#E53935"
                                            TextColor="White"
                                            CornerRadius="8"
                                            FontAttributes="Bold"
                                            Clicked="OnHardDeleteClicked"
                                            Padding="10,0"/>
                                </HorizontalStackLayout>

                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
